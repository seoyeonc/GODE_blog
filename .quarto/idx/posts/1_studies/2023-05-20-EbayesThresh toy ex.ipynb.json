{"title":"EbayesThresh Toy ex","markdown":{"yaml":{"title":"EbayesThresh Toy ex","author":"SEOYEON CHOI","date":"2023-05-18","categories":["Ebayesthresh"]},"headingText":"Import","containsRefs":false,"markdown":"\n\n\n- While ${\\bf p}_y$ serves as a consistent estimator for $\\mathbb{E}[|{\\bf V}^H{\\bf y}|^2]$, it is not an efficient estimator, and therefore, improvement is needed [@djuric2018cooperative]. \nThe traditional approach for improvement is to use the windowed periodogram.\n\n- The windowed periodogram is efficient in detecting specific frequencies or periods, but it may not be as efficient in estimating the underlying function. One notable paper that utilized the windowed periodogram is the one that detected the El Niño phenomenon.\n\n- As this structure exhibits a \"sparse signal + heavy-tailed\" characteristics, by applying Bayesian modeling and thresholding ${\\bf p}_y$, we can estimate an appropriate ${\\bf p}_{pp}$ as discussed in [@johnstone2004needles].\n\n\n# Bayesian Model\n\n$x_i \\sim N(\\mu_i,1)$\n\n[확률변수](https://guebin.github.io/AP2023/posts/II.%20%ED%99%95%EB%A5%A0%EB%A1%A0%EA%B8%B0%EC%B4%88/2023-05-02-09wk.html)가 잘 정의되어 있을때, 여기서 $\\mu_i$를 정하는 Baysian.\n\n- $\\mu_i \\sim$ 사전분포($\\mu_i$를 뽑을 수 있는)\n- $(\\mu_i | X_i = x_i)^n_{i=1} \\sim$ 사후분포\n\nex) $N(10,1) \\sim$ 사전분포\n\n관측치\n\n관측치를 보니 평균이 10이 아닌 것 같다.\n\n$N(10-3,1) \\sim$ 사후분포\n\n- 여기서, $10-3$이 posterior meman\n- 사후 분포를 정의할때, 이벤트의 mean이냐, median이냐로 잡는 방법은 정해진 것이 아니다.(이베이즈에서는 median으로 잡음)\n\nEbayes는 사전분포를 Heavy-tail으로 정의했다.\n\n**heavy tail?**\n\n![image.png](attachment:9c4b08eb-c3d0-4414-960e-f5a50b79799f.png)\n\n$\\mu_x \\sim$ Double Exponential $= p_{pp} + p_{ac}$ -> 혼합형(misture) = pure point + absolutely continuous\n\n$E(\\mu_i | X_i = x_i) = \\hat{\\mu}_i$ -> thresholding의 결과\n\n$f_{prior}(\\mu) = (1-w)\\delta_0(\\mu) + w \\gamma (\\mu)$\n\n- $\\delta_0$ = [디렉함수(특정값이 아니면 다 0으로 봄)](https://guebin.github.io/AP2023/posts/II.%20%ED%99%95%EB%A5%A0%EB%A1%A0%EA%B8%B0%EC%B4%88/2023-06-06-14wk.html#%EC%9D%B4%EC%82%B0%ED%99%95%EB%A5%A0%EB%B3%80%EC%88%98)\n- $\\gamma = \\frac{a}{2} e^{-a|\\mu|}$\n\n**Ebayes의 역할 = 자동으로 $w$를 계산 혹은 추정**\n\n- $1-w$ 확률로 $\\delta_0$를 정의, $w$의 확룔로 $\\gamma$를 정의.\n\n$X_i = \\mu_i + \\epsilon_i, \\epsilon_i \\sim N(0,1)$에서 $\\mu_i$를 찾는게 목적이다. 이게 바로 $\\eta$값\n\n1. Ebayes로 sparse signal만 골러낼 것이다.\n2. 평균 이상의 값에서 자를 것이다.\n    - thresh(임계치)를 잡는 게 어려울 텐데, 위에서 이베이즈가 $w$를 자동으로 잡아 확률 계산되는 방법론을 제안한 것,\n3. baysian modeling 사용하여 heavy tail + impulse(sparse)에서 posterior median 추정하여 임계값thresh으로 $p$에서 $p_{pp}$를 추출하는 것이 GODE 목적\n\n# EbayesThresh\n\n`-` 관찰한 신호 \n\n`-` 퓨리에 변환 \n\n`-` threshed \n\n`-` 역퓨리에변환 \n\n# Result\n\n# In article\n\n$X_i$에서 $\\mu_i$ 추출 가능하는 것을 증명할 예제\n\n```python\ndef trim(f):\n    f = np.array(f)\n    if len(f.shape)==1: f = f.reshape(-1,1)\n    T,N = f.shape\n    Psi = make_Psi(T)\n    fbar = Psi.T @ f # apply dft \n    fbar_threshed = np.stack([ebayesthresh(FloatVector(fbar[:,i])) for i in range(N)],axis=1)\n    fhat = Psi @ fbar_threshed # inverse dft \n    return fhat\n```\n\nPsi\n\nfourier transform\n\nEbayesthresh/trim\n\nfhat\n","srcMarkdownNoYaml":"\n\n# Import\n\n- While ${\\bf p}_y$ serves as a consistent estimator for $\\mathbb{E}[|{\\bf V}^H{\\bf y}|^2]$, it is not an efficient estimator, and therefore, improvement is needed [@djuric2018cooperative]. \nThe traditional approach for improvement is to use the windowed periodogram.\n\n- The windowed periodogram is efficient in detecting specific frequencies or periods, but it may not be as efficient in estimating the underlying function. One notable paper that utilized the windowed periodogram is the one that detected the El Niño phenomenon.\n\n- As this structure exhibits a \"sparse signal + heavy-tailed\" characteristics, by applying Bayesian modeling and thresholding ${\\bf p}_y$, we can estimate an appropriate ${\\bf p}_{pp}$ as discussed in [@johnstone2004needles].\n\n\n# Bayesian Model\n\n$x_i \\sim N(\\mu_i,1)$\n\n[확률변수](https://guebin.github.io/AP2023/posts/II.%20%ED%99%95%EB%A5%A0%EB%A1%A0%EA%B8%B0%EC%B4%88/2023-05-02-09wk.html)가 잘 정의되어 있을때, 여기서 $\\mu_i$를 정하는 Baysian.\n\n- $\\mu_i \\sim$ 사전분포($\\mu_i$를 뽑을 수 있는)\n- $(\\mu_i | X_i = x_i)^n_{i=1} \\sim$ 사후분포\n\nex) $N(10,1) \\sim$ 사전분포\n\n관측치\n\n관측치를 보니 평균이 10이 아닌 것 같다.\n\n$N(10-3,1) \\sim$ 사후분포\n\n- 여기서, $10-3$이 posterior meman\n- 사후 분포를 정의할때, 이벤트의 mean이냐, median이냐로 잡는 방법은 정해진 것이 아니다.(이베이즈에서는 median으로 잡음)\n\nEbayes는 사전분포를 Heavy-tail으로 정의했다.\n\n**heavy tail?**\n\n![image.png](attachment:9c4b08eb-c3d0-4414-960e-f5a50b79799f.png)\n\n$\\mu_x \\sim$ Double Exponential $= p_{pp} + p_{ac}$ -> 혼합형(misture) = pure point + absolutely continuous\n\n$E(\\mu_i | X_i = x_i) = \\hat{\\mu}_i$ -> thresholding의 결과\n\n$f_{prior}(\\mu) = (1-w)\\delta_0(\\mu) + w \\gamma (\\mu)$\n\n- $\\delta_0$ = [디렉함수(특정값이 아니면 다 0으로 봄)](https://guebin.github.io/AP2023/posts/II.%20%ED%99%95%EB%A5%A0%EB%A1%A0%EA%B8%B0%EC%B4%88/2023-06-06-14wk.html#%EC%9D%B4%EC%82%B0%ED%99%95%EB%A5%A0%EB%B3%80%EC%88%98)\n- $\\gamma = \\frac{a}{2} e^{-a|\\mu|}$\n\n**Ebayes의 역할 = 자동으로 $w$를 계산 혹은 추정**\n\n- $1-w$ 확률로 $\\delta_0$를 정의, $w$의 확룔로 $\\gamma$를 정의.\n\n$X_i = \\mu_i + \\epsilon_i, \\epsilon_i \\sim N(0,1)$에서 $\\mu_i$를 찾는게 목적이다. 이게 바로 $\\eta$값\n\n1. Ebayes로 sparse signal만 골러낼 것이다.\n2. 평균 이상의 값에서 자를 것이다.\n    - thresh(임계치)를 잡는 게 어려울 텐데, 위에서 이베이즈가 $w$를 자동으로 잡아 확률 계산되는 방법론을 제안한 것,\n3. baysian modeling 사용하여 heavy tail + impulse(sparse)에서 posterior median 추정하여 임계값thresh으로 $p$에서 $p_{pp}$를 추출하는 것이 GODE 목적\n\n# EbayesThresh\n\n`-` 관찰한 신호 \n\n`-` 퓨리에 변환 \n\n`-` threshed \n\n`-` 역퓨리에변환 \n\n# Result\n\n# In article\n\n$X_i$에서 $\\mu_i$ 추출 가능하는 것을 증명할 예제\n\n```python\ndef trim(f):\n    f = np.array(f)\n    if len(f.shape)==1: f = f.reshape(-1,1)\n    T,N = f.shape\n    Psi = make_Psi(T)\n    fbar = Psi.T @ f # apply dft \n    fbar_threshed = np.stack([ebayesthresh(FloatVector(fbar[:,i])) for i in range(N)],axis=1)\n    fhat = Psi @ fbar_threshed # inverse dft \n    return fhat\n```\n\nPsi\n\nfourier transform\n\nEbayesthresh/trim\n\nfhat\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"2023-05-20-EbayesThresh toy ex.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.527","theme":{"light":"flatly"},"code-copy":false,"title-block-banner":true,"title":"EbayesThresh Toy ex","author":"SEOYEON CHOI","date":"2023-05-18","categories":["Ebayesthresh"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}